<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">

<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"/>
  <meta name="generator" content="distill" />

  <style type="text/css">
  /* Hide doc at startup (prevent jankiness while JS renders/transforms) */
  body {
    visibility: hidden;
  }
  </style>

 <!--radix_placeholder_import_source-->
 <!--/radix_placeholder_import_source-->

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #545454; font-weight: bold; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #a1024a; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007faa; font-weight: bold; } /* ControlFlow */
code span.ch { color: #008000; } /* Char */
code span.cn { color: #d91e18; } /* Constant */
code span.co { color: #545454; } /* Comment */
code span.cv { color: #545454; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #aa5d00; } /* DataType */
code span.dv { color: #a1024a; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #a1024a; } /* Float */
code span.fu { color: #4254a7; } /* Function */
code span.im { } /* Import */
code span.in { color: #545454; font-weight: bold; } /* Information */
code span.kw { color: #007faa; font-weight: bold; } /* Keyword */
code span.op { color: #696969; } /* Operator */
code span.ot { color: #007faa; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #008000; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #008000; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #008000; } /* VerbatimString */
code span.wa { color: #545454; font-weight: bold; font-style: italic; } /* Warning */
</style>

  <!--radix_placeholder_meta_tags-->
  <title>The Significance of the adjusted R squared coefficient</title>

  <meta property="description" itemprop="description" content="A sound re-interpretation of the adjusted $R^2$ value for model comparison."/>


  <!--  https://schema.org/Article -->
  <meta property="article:published" itemprop="datePublished" content="2019-04-10"/>
  <meta property="article:created" itemprop="dateCreated" content="2019-04-10"/>
  <meta name="article:author" content="Olivier Binette"/>

  <!--  https://developers.facebook.com/docs/sharing/webmasters#markup -->
  <meta property="og:title" content="The Significance of the adjusted R squared coefficient"/>
  <meta property="og:type" content="article"/>
  <meta property="og:description" content="A sound re-interpretation of the adjusted $R^2$ value for model comparison."/>
  <meta property="og:locale" content="en_US"/>

  <!--  https://dev.twitter.com/cards/types/summary -->
  <meta property="twitter:card" content="summary"/>
  <meta property="twitter:title" content="The Significance of the adjusted R squared coefficient"/>
  <meta property="twitter:description" content="A sound re-interpretation of the adjusted $R^2$ value for model comparison."/>

  <!--/radix_placeholder_meta_tags-->
  <!--radix_placeholder_rmarkdown_metadata-->

  <script type="text/json" id="radix-rmarkdown-metadata">
  {"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["title","description","author","date","output"]}},"value":[{"type":"character","attributes":{},"value":["The Significance of the adjusted R squared coefficient"]},{"type":"character","attributes":{},"value":["A sound re-interpretation of the adjusted $R^2$ value for model comparison.\n"]},{"type":"list","attributes":{},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["name"]}},"value":[{"type":"character","attributes":{},"value":["Olivier Binette"]}]}]},{"type":"character","attributes":{},"value":["04-10-2019"]},{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["distill::distill_article"]}},"value":[{"type":"list","attributes":{"names":{"type":"character","attributes":{},"value":["self_contained"]}},"value":[{"type":"logical","attributes":{},"value":[false]}]}]}]}
  </script>
  <!--/radix_placeholder_rmarkdown_metadata-->
  
  <script type="text/json" id="radix-resource-manifest">
  {"type":"character","attributes":{},"value":["the-significance-of-the-adjusted-r-squared-coefficient_files/anchor-4.2.2/anchor.min.js","the-significance-of-the-adjusted-r-squared-coefficient_files/bowser-1.9.3/bowser.min.js","the-significance-of-the-adjusted-r-squared-coefficient_files/distill-2.2.21/template.v2.js","the-significance-of-the-adjusted-r-squared-coefficient_files/header-attrs-2.4/header-attrs.js","the-significance-of-the-adjusted-r-squared-coefficient_files/jquery-1.11.3/jquery.min.js","the-significance-of-the-adjusted-r-squared-coefficient_files/webcomponents-2.0.0/webcomponents.js"]}
  </script>
  <!--radix_placeholder_navigation_in_header-->
  <!--/radix_placeholder_navigation_in_header-->
  <!--radix_placeholder_distill-->

  <style type="text/css">

  body {
    background-color: white;
  }

  .pandoc-table {
    width: 100%;
  }

  .pandoc-table>caption {
    margin-bottom: 10px;
  }

  .pandoc-table th:not([align]) {
    text-align: left;
  }

  .pagedtable-footer {
    font-size: 15px;
  }

  d-byline .byline {
    grid-template-columns: 2fr 2fr;
  }

  d-byline .byline h3 {
    margin-block-start: 1.5em;
  }

  d-byline .byline .authors-affiliations h3 {
    margin-block-start: 0.5em;
  }

  .authors-affiliations .orcid-id {
    width: 16px;
    height:16px;
    margin-left: 4px;
    margin-right: 4px;
    vertical-align: middle;
    padding-bottom: 2px;
  }

  d-title .dt-tags {
    margin-top: 1em;
    grid-column: text;
  }

  .dt-tags .dt-tag {
    text-decoration: none;
    display: inline-block;
    color: rgba(0,0,0,0.6);
    padding: 0em 0.4em;
    margin-right: 0.5em;
    margin-bottom: 0.4em;
    font-size: 70%;
    border: 1px solid rgba(0,0,0,0.2);
    border-radius: 3px;
    text-transform: uppercase;
    font-weight: 500;
  }

  d-article table.gt_table td,
  d-article table.gt_table th {
    border-bottom: none;
  }

  .html-widget {
    margin-bottom: 2.0em;
  }

  .l-screen-inset {
    padding-right: 16px;
  }

  .l-screen .caption {
    margin-left: 10px;
  }

  .shaded {
    background: rgb(247, 247, 247);
    padding-top: 20px;
    padding-bottom: 20px;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    border-bottom: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .html-widget {
    margin-bottom: 0;
    border: 1px solid rgba(0, 0, 0, 0.1);
  }

  .shaded .shaded-content {
    background: white;
  }

  .text-output {
    margin-top: 0;
    line-height: 1.5em;
  }

  .hidden {
    display: none !important;
  }

  d-article {
    padding-top: 2.5rem;
    padding-bottom: 30px;
  }

  d-appendix {
    padding-top: 30px;
  }

  d-article>p>img {
    width: 100%;
  }

  d-article h2 {
    margin: 1rem 0 1.5rem 0;
  }

  d-article h3 {
    margin-top: 1.5rem;
  }

  d-article iframe {
    border: 1px solid rgba(0, 0, 0, 0.1);
    margin-bottom: 2.0em;
    width: 100%;
  }

  /* Tweak code blocks */

  d-article div.sourceCode code,
  d-article pre code {
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
  }

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: hidden;
  }

  d-article div.sourceCode {
    background-color: white;
  }

  d-article div.sourceCode pre {
    padding-left: 10px;
    font-size: 12px;
    border-left: 2px solid rgba(0,0,0,0.1);
  }

  d-article pre {
    font-size: 12px;
    color: black;
    background: none;
    margin-top: 0;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  d-article pre a {
    border-bottom: none;
  }

  d-article pre a:hover {
    border-bottom: none;
    text-decoration: underline;
  }

  @media(min-width: 768px) {

  d-article pre,
  d-article div.sourceCode,
  d-article div.sourceCode pre {
    overflow: visible !important;
  }

  d-article div.sourceCode pre {
    padding-left: 18px;
    font-size: 14px;
  }

  d-article pre {
    font-size: 14px;
  }

  }

  figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  /* CSS for d-contents */

  .d-contents {
    grid-column: text;
    color: rgba(0,0,0,0.8);
    font-size: 0.9em;
    padding-bottom: 1em;
    margin-bottom: 1em;
    padding-bottom: 0.5em;
    margin-bottom: 1em;
    padding-left: 0.25em;
    justify-self: start;
  }

  @media(min-width: 1000px) {
    .d-contents.d-contents-float {
      height: 0;
      grid-column-start: 1;
      grid-column-end: 4;
      justify-self: center;
      padding-right: 3em;
      padding-left: 2em;
    }
  }

  .d-contents nav h3 {
    font-size: 18px;
    margin-top: 0;
    margin-bottom: 1em;
  }

  .d-contents li {
    list-style-type: none
  }

  .d-contents nav > ul {
    padding-left: 0;
  }

  .d-contents ul {
    padding-left: 1em
  }

  .d-contents nav ul li {
    margin-top: 0.6em;
    margin-bottom: 0.2em;
  }

  .d-contents nav a {
    font-size: 13px;
    border-bottom: none;
    text-decoration: none
    color: rgba(0, 0, 0, 0.8);
  }

  .d-contents nav a:hover {
    text-decoration: underline solid rgba(0, 0, 0, 0.6)
  }

  .d-contents nav > ul > li > a {
    font-weight: 600;
  }

  .d-contents nav > ul > li > ul {
    font-weight: inherit;
  }

  .d-contents nav > ul > li > ul > li {
    margin-top: 0.2em;
  }


  .d-contents nav ul {
    margin-top: 0;
    margin-bottom: 0.25em;
  }

  .d-article-with-toc h2:nth-child(2) {
    margin-top: 0;
  }


  /* Figure */

  .figure {
    position: relative;
    margin-bottom: 2.5em;
    margin-top: 1.5em;
  }

  .figure img {
    width: 100%;
  }

  .figure .caption {
    color: rgba(0, 0, 0, 0.6);
    font-size: 12px;
    line-height: 1.5em;
  }

  .figure img.external {
    background: white;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 1px 8px rgba(0, 0, 0, 0.1);
    padding: 18px;
    box-sizing: border-box;
  }

  .figure .caption a {
    color: rgba(0, 0, 0, 0.6);
  }

  .figure .caption b,
  .figure .caption strong, {
    font-weight: 600;
    color: rgba(0, 0, 0, 1.0);
  }

  /* Citations */

  d-article .citation {
    color: inherit;
    cursor: inherit;
  }

  div.hanging-indent{
    margin-left: 1em; text-indent: -1em;
  }


  /* Tweak 1000px media break to show more text */

  @media(min-width: 1000px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 80px [middle-start] 50px [text-start kicker-end] 65px 65px 65px 65px 65px 65px 65px 65px [text-end gutter-start] 65px [middle-end] 65px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 16px;
    }

    .grid {
      grid-column-gap: 16px;
    }

    d-article {
      font-size: 1.06rem;
      line-height: 1.7em;
    }
    figure .caption, .figure .caption, figure figcaption {
      font-size: 13px;
    }
  }

  @media(min-width: 1180px) {
    .base-grid,
    distill-header,
    d-title,
    d-abstract,
    d-article,
    d-appendix,
    distill-appendix,
    d-byline,
    d-footnote-list,
    d-citation-list,
    distill-footer {
      grid-template-columns: [screen-start] 1fr [page-start kicker-start] 60px [middle-start] 60px [text-start kicker-end] 60px 60px 60px 60px 60px 60px 60px 60px [text-end gutter-start] 60px [middle-end] 60px [page-end gutter-end] 1fr [screen-end];
      grid-column-gap: 32px;
    }

    .grid {
      grid-column-gap: 32px;
    }
  }


  /* Get the citation styles for the appendix (not auto-injected on render since
     we do our own rendering of the citation appendix) */

  d-appendix .citation-appendix,
  .d-appendix .citation-appendix {
    font-size: 11px;
    line-height: 15px;
    border-left: 1px solid rgba(0, 0, 0, 0.1);
    padding-left: 18px;
    border: 1px solid rgba(0,0,0,0.1);
    background: rgba(0, 0, 0, 0.02);
    padding: 10px 18px;
    border-radius: 3px;
    color: rgba(150, 150, 150, 1);
    overflow: hidden;
    margin-top: -12px;
    white-space: pre-wrap;
    word-wrap: break-word;
  }

  /* Include appendix styles here so they can be overridden */

  d-appendix {
    contain: layout style;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-top: 60px;
    margin-bottom: 0;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
    color: rgba(0,0,0,0.5);
    padding-top: 60px;
    padding-bottom: 48px;
  }

  d-appendix h3 {
    grid-column: page-start / text-start;
    font-size: 15px;
    font-weight: 500;
    margin-top: 1em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.65);
  }

  d-appendix h3 + * {
    margin-top: 1em;
  }

  d-appendix ol {
    padding: 0 0 0 15px;
  }

  @media (min-width: 768px) {
    d-appendix ol {
      padding: 0 0 0 30px;
      margin-left: -30px;
    }
  }

  d-appendix li {
    margin-bottom: 1em;
  }

  d-appendix a {
    color: rgba(0, 0, 0, 0.6);
  }

  d-appendix > * {
    grid-column: text;
  }

  d-appendix > d-footnote-list,
  d-appendix > d-citation-list,
  d-appendix > distill-appendix {
    grid-column: screen;
  }

  /* Include footnote styles here so they can be overridden */

  d-footnote-list {
    contain: layout style;
  }

  d-footnote-list > * {
    grid-column: text;
  }

  d-footnote-list a.footnote-backlink {
    color: rgba(0,0,0,0.3);
    padding-left: 0.5em;
  }



  /* Anchor.js */

  .anchorjs-link {
    /*transition: all .25s linear; */
    text-decoration: none;
    border-bottom: none;
  }
  *:hover > .anchorjs-link {
    margin-left: -1.125em !important;
    text-decoration: none;
    border-bottom: none;
  }

  /* Social footer */

  .social_footer {
    margin-top: 30px;
    margin-bottom: 0;
    color: rgba(0,0,0,0.67);
  }

  .disqus-comments {
    margin-right: 30px;
  }

  .disqus-comment-count {
    border-bottom: 1px solid rgba(0, 0, 0, 0.4);
    cursor: pointer;
  }

  #disqus_thread {
    margin-top: 30px;
  }

  .article-sharing a {
    border-bottom: none;
    margin-right: 8px;
  }

  .article-sharing a:hover {
    border-bottom: none;
  }

  .sidebar-section.subscribe {
    font-size: 12px;
    line-height: 1.6em;
  }

  .subscribe p {
    margin-bottom: 0.5em;
  }


  .article-footer .subscribe {
    font-size: 15px;
    margin-top: 45px;
  }


  .sidebar-section.custom {
    font-size: 12px;
    line-height: 1.6em;
  }

  .custom p {
    margin-bottom: 0.5em;
  }


  /* Improve display for browsers without grid (IE/Edge <= 15) */

  .downlevel {
    line-height: 1.6em;
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Fira Sans", "Droid Sans", "Helvetica Neue", Arial, sans-serif;
    margin: 0;
  }

  .downlevel .d-title {
    padding-top: 6rem;
    padding-bottom: 1.5rem;
  }

  .downlevel .d-title h1 {
    font-size: 50px;
    font-weight: 700;
    line-height: 1.1em;
    margin: 0 0 0.5rem;
  }

  .downlevel .d-title p {
    font-weight: 300;
    font-size: 1.2rem;
    line-height: 1.55em;
    margin-top: 0;
  }

  .downlevel .d-byline {
    padding-top: 0.8em;
    padding-bottom: 0.8em;
    font-size: 0.8rem;
    line-height: 1.8em;
  }

  .downlevel .section-separator {
    border: none;
    border-top: 1px solid rgba(0, 0, 0, 0.1);
  }

  .downlevel .d-article {
    font-size: 1.06rem;
    line-height: 1.7em;
    padding-top: 1rem;
    padding-bottom: 2rem;
  }


  .downlevel .d-appendix {
    padding-left: 0;
    padding-right: 0;
    max-width: none;
    font-size: 0.8em;
    line-height: 1.7em;
    margin-bottom: 0;
    color: rgba(0,0,0,0.5);
    padding-top: 40px;
    padding-bottom: 48px;
  }

  .downlevel .footnotes ol {
    padding-left: 13px;
  }

  .downlevel .base-grid,
  .downlevel .distill-header,
  .downlevel .d-title,
  .downlevel .d-abstract,
  .downlevel .d-article,
  .downlevel .d-appendix,
  .downlevel .distill-appendix,
  .downlevel .d-byline,
  .downlevel .d-footnote-list,
  .downlevel .d-citation-list,
  .downlevel .distill-footer,
  .downlevel .appendix-bottom,
  .downlevel .posts-container {
    padding-left: 40px;
    padding-right: 40px;
  }

  @media(min-width: 768px) {
    .downlevel .base-grid,
    .downlevel .distill-header,
    .downlevel .d-title,
    .downlevel .d-abstract,
    .downlevel .d-article,
    .downlevel .d-appendix,
    .downlevel .distill-appendix,
    .downlevel .d-byline,
    .downlevel .d-footnote-list,
    .downlevel .d-citation-list,
    .downlevel .distill-footer,
    .downlevel .appendix-bottom,
    .downlevel .posts-container {
    padding-left: 150px;
    padding-right: 150px;
    max-width: 900px;
  }
  }

  .downlevel pre code {
    display: block;
    border-left: 2px solid rgba(0, 0, 0, .1);
    padding: 0 0 0 20px;
    font-size: 14px;
  }

  .downlevel code, .downlevel pre {
    color: black;
    background: none;
    font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
    text-align: left;
    white-space: pre;
    word-spacing: normal;
    word-break: normal;
    word-wrap: normal;
    line-height: 1.5;

    -moz-tab-size: 4;
    -o-tab-size: 4;
    tab-size: 4;

    -webkit-hyphens: none;
    -moz-hyphens: none;
    -ms-hyphens: none;
    hyphens: none;
  }

  </style>

  <script type="application/javascript">

  function is_downlevel_browser() {
    if (bowser.isUnsupportedBrowser({ msie: "12", msedge: "16"},
                                   window.navigator.userAgent)) {
      return true;
    } else {
      return window.load_distill_framework === undefined;
    }
  }

  // show body when load is complete
  function on_load_complete() {

    // add anchors
    if (window.anchors) {
      window.anchors.options.placement = 'left';
      window.anchors.add('d-article > h2, d-article > h3, d-article > h4, d-article > h5');
    }


    // set body to visible
    document.body.style.visibility = 'visible';

    // force redraw for leaflet widgets
    if (window.HTMLWidgets) {
      var maps = window.HTMLWidgets.findAll(".leaflet");
      $.each(maps, function(i, el) {
        var map = this.getMap();
        map.invalidateSize();
        map.eachLayer(function(layer) {
          if (layer instanceof L.TileLayer)
            layer.redraw();
        });
      });
    }

    // trigger 'shown' so htmlwidgets resize
    $('d-article').trigger('shown');
  }

  function init_distill() {

    init_common();

    // create front matter
    var front_matter = $('<d-front-matter></d-front-matter>');
    $('#distill-front-matter').wrap(front_matter);

    // create d-title
    $('.d-title').changeElementType('d-title');

    // create d-byline
    var byline = $('<d-byline></d-byline>');
    $('.d-byline').replaceWith(byline);

    // create d-article
    var article = $('<d-article></d-article>');
    $('.d-article').wrap(article).children().unwrap();

    // move posts container into article
    $('.posts-container').appendTo($('d-article'));

    // create d-appendix
    $('.d-appendix').changeElementType('d-appendix');

    // flag indicating that we have appendix items
    var appendix = $('.appendix-bottom').children('h3').length > 0;

    // replace footnotes with <d-footnote>
    $('.footnote-ref').each(function(i, val) {
      appendix = true;
      var href = $(this).attr('href');
      var id = href.replace('#', '');
      var fn = $('#' + id);
      var fn_p = $('#' + id + '>p');
      fn_p.find('.footnote-back').remove();
      var text = fn_p.html();
      var dtfn = $('<d-footnote></d-footnote>');
      dtfn.html(text);
      $(this).replaceWith(dtfn);
    });
    // remove footnotes
    $('.footnotes').remove();

    // move refs into #references-listing
    $('#references-listing').replaceWith($('#refs'));

    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      var id = $(this).attr('id');
      $('.d-contents a[href="#' + id + '"]').parent().remove();
      appendix = true;
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('d-appendix'));
    });

    // show d-appendix if we have appendix content
    $("d-appendix").css('display', appendix ? 'grid' : 'none');

    // localize layout chunks to just output
    $('.layout-chunk').each(function(i, val) {

      // capture layout
      var layout = $(this).attr('data-layout');

      // apply layout to markdown level block elements
      var elements = $(this).children().not('div.sourceCode, pre, script');
      elements.each(function(i, el) {
        var layout_div = $('<div class="' + layout + '"></div>');
        if (layout_div.hasClass('shaded')) {
          var shaded_content = $('<div class="shaded-content"></div>');
          $(this).wrap(shaded_content);
          $(this).parent().wrap(layout_div);
        } else {
          $(this).wrap(layout_div);
        }
      });


      // unwrap the layout-chunk div
      $(this).children().unwrap();
    });

    // remove code block used to force  highlighting css
    $('.distill-force-highlighting-css').parent().remove();

    // remove empty line numbers inserted by pandoc when using a
    // custom syntax highlighting theme
    $('code.sourceCode a:empty').remove();

    // load distill framework
    load_distill_framework();

    // wait for window.distillRunlevel == 4 to do post processing
    function distill_post_process() {

      if (!window.distillRunlevel || window.distillRunlevel < 4)
        return;

      // hide author/affiliations entirely if we have no authors
      var front_matter = JSON.parse($("#distill-front-matter").html());
      var have_authors = front_matter.authors && front_matter.authors.length > 0;
      if (!have_authors)
        $('d-byline').addClass('hidden');

      // article with toc class
      $('.d-contents').parent().addClass('d-article-with-toc');

      // strip links that point to #
      $('.authors-affiliations').find('a[href="#"]').removeAttr('href');

      // add orcid ids
      $('.authors-affiliations').find('.author').each(function(i, el) {
        var orcid_id = front_matter.authors[i].orcidID;
        if (orcid_id) {
          var a = $('<a></a>');
          a.attr('href', 'https://orcid.org/' + orcid_id);
          var img = $('<img></img>');
          img.addClass('orcid-id');
          img.attr('alt', 'ORCID ID');
          img.attr('src','data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYwIDYxLjEzNDc3NywgMjAxMC8wMi8xMi0xNzozMjowMCAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDo1N0NEMjA4MDI1MjA2ODExOTk0QzkzNTEzRjZEQTg1NyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDozM0NDOEJGNEZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDozM0NDOEJGM0ZGNTcxMUUxODdBOEVCODg2RjdCQ0QwOSIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1IE1hY2ludG9zaCI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkZDN0YxMTc0MDcyMDY4MTE5NUZFRDc5MUM2MUUwNEREIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjU3Q0QyMDgwMjUyMDY4MTE5OTRDOTM1MTNGNkRBODU3Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+84NovQAAAR1JREFUeNpiZEADy85ZJgCpeCB2QJM6AMQLo4yOL0AWZETSqACk1gOxAQN+cAGIA4EGPQBxmJA0nwdpjjQ8xqArmczw5tMHXAaALDgP1QMxAGqzAAPxQACqh4ER6uf5MBlkm0X4EGayMfMw/Pr7Bd2gRBZogMFBrv01hisv5jLsv9nLAPIOMnjy8RDDyYctyAbFM2EJbRQw+aAWw/LzVgx7b+cwCHKqMhjJFCBLOzAR6+lXX84xnHjYyqAo5IUizkRCwIENQQckGSDGY4TVgAPEaraQr2a4/24bSuoExcJCfAEJihXkWDj3ZAKy9EJGaEo8T0QSxkjSwORsCAuDQCD+QILmD1A9kECEZgxDaEZhICIzGcIyEyOl2RkgwAAhkmC+eAm0TAAAAABJRU5ErkJggg==');
          a.append(img);
          $(this).append(a);
        }
      });

      // hide elements of author/affiliations grid that have no value
      function hide_byline_column(caption) {
        $('d-byline').find('h3:contains("' + caption + '")').parent().css('visibility', 'hidden');
      }

      // affiliations
      var have_affiliations = false;
      for (var i = 0; i<front_matter.authors.length; ++i) {
        var author = front_matter.authors[i];
        if (author.affiliation !== "&nbsp;") {
          have_affiliations = true;
          break;
        }
      }
      if (!have_affiliations)
        $('d-byline').find('h3:contains("Affiliations")').css('visibility', 'hidden');

      // published date
      if (!front_matter.publishedDate)
        hide_byline_column("Published");

      // document object identifier
      var doi = $('d-byline').find('h3:contains("DOI")');
      var doi_p = doi.next().empty();
      if (!front_matter.doi) {
        // if we have a citation and valid citationText then link to that
        if ($('#citation').length > 0 && front_matter.citationText) {
          doi.html('Citation');
          $('<a href="#citation"></a>')
            .text(front_matter.citationText)
            .appendTo(doi_p);
        } else {
          hide_byline_column("DOI");
        }
      } else {
        $('<a></a>')
           .attr('href', "https://doi.org/" + front_matter.doi)
           .html(front_matter.doi)
           .appendTo(doi_p);
      }

       // change plural form of authors/affiliations
      if (front_matter.authors.length === 1) {
        var grid = $('.authors-affiliations');
        grid.children('h3:contains("Authors")').text('Author');
        grid.children('h3:contains("Affiliations")').text('Affiliation');
      }

      // remove d-appendix and d-footnote-list local styles
      $('d-appendix > style:first-child').remove();
      $('d-footnote-list > style:first-child').remove();

      // move appendix-bottom entries to the bottom
      $('.appendix-bottom').appendTo('d-appendix').children().unwrap();
      $('.appendix-bottom').remove();

      // clear polling timer
      clearInterval(tid);

      // show body now that everything is ready
      on_load_complete();
    }

    var tid = setInterval(distill_post_process, 50);
    distill_post_process();

  }

  function init_downlevel() {

    init_common();

     // insert hr after d-title
    $('.d-title').after($('<hr class="section-separator"/>'));

    // check if we have authors
    var front_matter = JSON.parse($("#distill-front-matter").html());
    var have_authors = front_matter.authors && front_matter.authors.length > 0;

    // manage byline/border
    if (!have_authors)
      $('.d-byline').remove();
    $('.d-byline').after($('<hr class="section-separator"/>'));
    $('.d-byline a').remove();

    // remove toc
    $('.d-contents').remove();

    // move appendix elements
    $('h1.appendix, h2.appendix').each(function(i, val) {
      $(this).changeElementType('h3');
    });
    $('h3.appendix').each(function(i, val) {
      $(this).nextUntil($('h1, h2, h3')).addBack().appendTo($('.d-appendix'));
    });


    // inject headers into references and footnotes
    var refs_header = $('<h3></h3>');
    refs_header.text('References');
    $('#refs').prepend(refs_header);

    var footnotes_header = $('<h3></h3');
    footnotes_header.text('Footnotes');
    $('.footnotes').children('hr').first().replaceWith(footnotes_header);

    // move appendix-bottom entries to the bottom
    $('.appendix-bottom').appendTo('.d-appendix').children().unwrap();
    $('.appendix-bottom').remove();

    // remove appendix if it's empty
    if ($('.d-appendix').children().length === 0)
      $('.d-appendix').remove();

    // prepend separator above appendix
    $('.d-appendix').before($('<hr class="section-separator" style="clear: both"/>'));

    // trim code
    $('pre>code').each(function(i, val) {
      $(this).html($.trim($(this).html()));
    });

    // move posts-container right before article
    $('.posts-container').insertBefore($('.d-article'));

    $('body').addClass('downlevel');

    on_load_complete();
  }


  function init_common() {

    // jquery plugin to change element types
    (function($) {
      $.fn.changeElementType = function(newType) {
        var attrs = {};

        $.each(this[0].attributes, function(idx, attr) {
          attrs[attr.nodeName] = attr.nodeValue;
        });

        this.replaceWith(function() {
          return $("<" + newType + "/>", attrs).append($(this).contents());
        });
      };
    })(jQuery);

    // prevent underline for linked images
    $('a > img').parent().css({'border-bottom' : 'none'});

    // mark non-body figures created by knitr chunks as 100% width
    $('.layout-chunk').each(function(i, val) {
      var figures = $(this).find('img, .html-widget');
      if ($(this).attr('data-layout') !== "l-body") {
        figures.css('width', '100%');
      } else {
        figures.css('max-width', '100%');
        figures.filter("[width]").each(function(i, val) {
          var fig = $(this);
          fig.css('width', fig.attr('width') + 'px');
        });

      }
    });

    // auto-append index.html to post-preview links in file: protocol
    // and in rstudio ide preview
    $('.post-preview').each(function(i, val) {
      if (window.location.protocol === "file:")
        $(this).attr('href', $(this).attr('href') + "index.html");
    });

    // get rid of index.html references in header
    if (window.location.protocol !== "file:") {
      $('.distill-site-header a[href]').each(function(i,val) {
        $(this).attr('href', $(this).attr('href').replace("index.html", "./"));
      });
    }

    // add class to pandoc style tables
    $('tr.header').parent('thead').parent('table').addClass('pandoc-table');
    $('.kable-table').children('table').addClass('pandoc-table');

    // add figcaption style to table captions
    $('caption').parent('table').addClass("figcaption");

    // initialize posts list
    if (window.init_posts_list)
      window.init_posts_list();

    // implmement disqus comment link
    $('.disqus-comment-count').click(function() {
      window.headroom_prevent_pin = true;
      $('#disqus_thread').toggleClass('hidden');
      if (!$('#disqus_thread').hasClass('hidden')) {
        var offset = $(this).offset();
        $(window).resize();
        $('html, body').animate({
          scrollTop: offset.top - 35
        });
      }
    });
  }

  document.addEventListener('DOMContentLoaded', function() {
    if (is_downlevel_browser())
      init_downlevel();
    else
      window.addEventListener('WebComponentsReady', init_distill);
  });

  </script>

  <!--/radix_placeholder_distill-->
  <script src="the-significance-of-the-adjusted-r-squared-coefficient_files/header-attrs-2.4/header-attrs.js"></script>
  <script src="the-significance-of-the-adjusted-r-squared-coefficient_files/jquery-1.11.3/jquery.min.js"></script>
  <script src="the-significance-of-the-adjusted-r-squared-coefficient_files/anchor-4.2.2/anchor.min.js"></script>
  <script src="the-significance-of-the-adjusted-r-squared-coefficient_files/bowser-1.9.3/bowser.min.js"></script>
  <script src="the-significance-of-the-adjusted-r-squared-coefficient_files/webcomponents-2.0.0/webcomponents.js"></script>
  <script src="the-significance-of-the-adjusted-r-squared-coefficient_files/distill-2.2.21/template.v2.js"></script>
  <!--radix_placeholder_site_in_header-->
  <!--/radix_placeholder_site_in_header-->


</head>

<body>

<!--radix_placeholder_front_matter-->

<script id="distill-front-matter" type="text/json">
{"title":"The Significance of the adjusted R squared coefficient","description":"A sound re-interpretation of the adjusted $R^2$ value for model comparison.","authors":[{"author":"Olivier Binette","authorURL":"#","affiliation":"&nbsp;","affiliationURL":"#","orcidID":""}],"publishedDate":"2019-04-10T00:00:00.000-04:00","citationText":"Binette, 2019"}
</script>

<!--/radix_placeholder_front_matter-->
<!--radix_placeholder_navigation_before_body-->
<!--/radix_placeholder_navigation_before_body-->
<!--radix_placeholder_site_before_body-->
<!--/radix_placeholder_site_before_body-->

<div class="d-title">
<h1>The Significance of the adjusted R squared coefficient</h1>
<!--radix_placeholder_categories-->
<!--/radix_placeholder_categories-->
<p><p>A sound re-interpretation of the adjusted <span class="math inline">\(R^2\)</span> value for model comparison.</p></p>
</div>

<div class="d-byline">
  Olivier Binette  
  
<br/>04-10-2019
</div>

<div class="d-article">
<p>My friend <a href="https://anthonycoache.ca/">Anthony Coache</a> and I have been curious about uses and misuses of the <em>adjusted</em> <span class="math inline">\(R^2\)</span> coefficient which comes up in linear regression for model comparison and as a measure of “goodness of fit”. We were underwhelmed by the depth of the literature arguing for its use, and wanted to show exactly how it behaves under certain sets of assumptions. Investigating the issue brought us to re-interpret the adjusted <span class="math inline">\(R^2\)</span> and to highlight a new distribution-free perspective on nested model comparison which is equivalent, under Gaussian assumptions, to Fisher’s classical <span class="math inline">\(F\)</span>-test. This generalizes to nested GLMs comparison and provides exact comparison tests that are not based on asymptotic approximations. We still have many questions to answer, but here’s some of what we’ve done.</p>
<!--more-->
<p>So, in the context of least squares linear regression, the model for relating a vector of <span class="math inline">\(n\)</span> observed responses <span class="math inline">\(Y\)</span> to <span class="math inline">\(p-1\)</span> independent covariates is <span class="math inline">\(Y = X \beta + \varepsilon\)</span>, where <span class="math inline">\(X\)</span> is the design matrix and <span class="math inline">\(\varepsilon\)</span> is the vector of random errors. One of many summary statistics arising from data analyses based on this model is the adjusted <span class="math inline">\(R^2\)</span> coefficient, defined as</p>
<p><span class="math display">\[R^2_a(Y, X) = 1 - \frac{\|\hat \varepsilon\|^2}{\left\|Y - \bar Y \right\|^2}\frac{n-1}{n-p},\]</span></p>
<p>where <span class="math inline">\(\hat \varepsilon\)</span> is the vector of residual errors and <span class="math inline">\(\bar Y\)</span> is the mean of <span class="math inline">\(Y\)</span> (Cramer, 1987; Ohtani, 2004). The <span class="math inline">\(R^2\)</span> coefficient and its adjusted counterpart are widely used as measures of goodness of fit, as model selection criteria and as estimators of the squared multiple correlation coefficient <span class="math inline">\(\rho^2\)</span> of the parent population. While their properties have been thoroughly studied in these contexts (Olkin, 1958; Helland, 1987; Cramer, 1987; Meepagala, 1992; Ohtani, 2004), the literature is scarce in explanations as to what, exactly, <span class="math inline">\(R^2_a\)</span> adjusts for in non-trivial cases. It is not an unbiased estimator of <span class="math inline">\(\rho^2\)</span> and the <em>degrees of freedom adjustment</em> heuristic (Theil, 1971) is of limited depth.</p>
<p>Here we show in what sense the adjusted <span class="math inline">\(R^2\)</span> coefficient may be considered “unbiased”. For nested models comparison, we also suggest how to test the significance of a <span class="math inline">\(R^2_a\)</span> difference between two nested models which is equivalent to Fisher’s <span class="math inline">\(F\)</span>-test under Gaussian assymptions. The <span class="math inline">\(R^2_a\)</span> test is however done from a largely distribution-free perspective which is conditional on the observation of <span class="math inline">\(Y\)</span>. The results are then reinterpreted under classical Gaussian assumptions, which emphasize the dual perspectives between those two tests.</p>
<h3 id="model-and-notations">Model and notations</h3>
<p>Given a matrix <span class="math inline">\(A\)</span>, let <span class="math inline">\(\text{Span}(A)\)</span> denote the subspace spanned by its columns and <span class="math inline">\(P_A\)</span> be the (orthogonal) projection on <span class="math inline">\(\text{Span}(A)\)</span>.</p>
<p>The commonly used linear regression model is <span class="math display">\[Y = X \beta + \varepsilon,\]</span> where <span class="math inline">\(Y\)</span> is a <span class="math inline">\(n \times 1\)</span> vector of observed responses, the design matrix <span class="math inline">\(X\)</span> consists of a constant column vector followed by <span class="math inline">\(p-1\)</span> column vectors of covariates, <span class="math inline">\(\beta\)</span> is the vector of parameters to be estimated and <span class="math inline">\(\varepsilon\)</span> is the vector of random errors. The fixed design matrix is supposed to be non-random and of full rank <span class="math inline">\(p\)</span>. Let also <span class="math inline">\(\hat \varepsilon = Y - P_X Y\)</span> denote the residuals errors obtained by linear least squares fitting.</p>
<h2 id="testing-for-an-increase-of-r2_a">Testing for an increase of <span class="math inline">\(R^2_a\)</span></h2>
<p>Suppose we have two design matrices <span class="math inline">\(X\)</span> and <span class="math inline">\(\tilde X\)</span>, where <span class="math inline">\(\text{Span}(X) \subset \text{Span}(\tilde X)\)</span>. Let <span class="math inline">\(p=\text{rank}(X)\)</span> and <span class="math inline">\(\tilde p = \text{rank}(\tilde X) = p+k\)</span>. Given the vector of observations <span class="math inline">\(Y\)</span>, we observe two values <span class="math inline">\(R^2 _ a (Y, X)\)</span> and <span class="math inline">\(R^2_ a (Y, \tilde X)\)</span> associated to the nested models. The classical way to test for a significant increase of <span class="math inline">\(R^2 _ a\)</span> is to carry out Fisher’s <span class="math inline">\(F\)</span>-test based on the statistics</p>
<p><span class="math display">\[
F = \frac{\| \hat Y_0 - \hat Y \|^2}{\| Y - \hat Y \|^2} \frac{n - \tilde p }{k},
\]</span></p>
<p>where <span class="math inline">\(\hat Y_0 = P_X Y\)</span> and <span class="math inline">\(\hat Y = P_ {\tilde X}Y\)</span>. This is a function of both <span class="math inline">\(R^2_a(Y, X)\)</span> and <span class="math inline">\(R^2_a(Y, \tilde X)\)</span>, which, under the assumption</p>
<p><span class="math display">\[
H_0: \quad Y = X \beta + \varepsilon
\]</span></p>
<p>for <span class="math inline">\(\varepsilon \sim N(0, \sigma^2 I_n)\)</span>, has an <span class="math inline">\(F\)</span>-distribution.</p>
<p>This is, however, a rather convoluted way of going about comparing the two numbers <span class="math inline">\(R^2_a(Y, X)\)</span> and <span class="math inline">\(R^2_a(Y, \tilde X)\)</span>. Can we do simpler, and can we drop the Gaussian assumption? The answer is yes, although we’ll have to change a bit our point of view on the problem.</p>
<h3 id="a-dual-perspective-on-nested-model-comparison">A Dual perspective on nested model comparison</h3>
<p>The whole point of nested model comparison is to see if the new covariates in <span class="math inline">\(\tilde X\)</span>, i.e. those that are not part of <span class="math inline">\(\text{Span}(X)\)</span>, bring new information about <span class="math inline">\(Y\)</span>. In the context of an exploratory analysis where the observations and predictors are all observed, we propose to change our perspective to the following testing procedure:</p>
<ol type="1">
<li>condition on the observation of <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> (consider them fixed, observed values);</li>
<li>tests if the new covariates in <span class="math inline">\(\tilde X\)</span> are random noise.</li>
</ol>
<p>Hence, rather than testing the model <span class="math inline">\(Y = X\beta + \varepsilon\)</span> under a Gaussian noise assumption, we test for <em>covariate randomness</em>, our null hypothesis becomes</p>
<p><span class="math display">\[
H_0&#39;:\quad \text{the complement of $\text{Span}(X)$ in $\text{Span}(\tilde X)$ is a random subspace.}
\]</span></p>
<p>This test can be carried out using any test statistic <span class="math inline">\(T\)</span>, and obviously the distribution of <span class="math inline">\(T\)</span> under <span class="math inline">\(H_0&#39;\)</span> (and conditionally on <span class="math inline">\(Y\)</span>), will not depend on the unknown parameter <span class="math inline">\(\beta\)</span> nor on the noise structure <span class="math inline">\(\varepsilon\)</span> (which has been conditionned out of randomness). In particular, we can take <span class="math inline">\(T = R^2_a(Y, \tilde X)\)</span>.</p>
<p>Does it make any sense? Well it does not change anything! The test obtained in this framework is entirely equivalent to Fisher’s <span class="math inline">\(F\)</span>-test we reviewed before: for any given observation of <span class="math inline">\(Y\)</span>, <span class="math inline">\(X\)</span> and <span class="math inline">\(\tilde X\)</span>, the two tests will give the same results.</p>
<p>Let me make all of this more precise.</p>
<h3 id="some-precisions">Some precisions</h3>
<p>Let <span class="math inline">\(\tilde X = [X \; W] \in \mathbb{R}^{n \times \tilde p}\)</span> be the concatenation of <span class="math inline">\(X\)</span> with a matrix <span class="math inline">\(W = [W_1 \, \cdots \, W_k]\)</span> of <span class="math inline">\(k\)</span> new covariates. The goal is to test whether or not <span class="math inline">\(R^2_a(Y, \tilde X)\)</span> has significantly increased from <span class="math inline">\(R^2_a(Y, X)\)</span>. Henceforth, we shall assume that both <span class="math inline">\(Y\)</span> and <span class="math inline">\(X\)</span> are fixed and the null hypothesis is</p>
<p><span class="math display">\[
H_0&#39;:\; \text{ the } W_i \text{ are independent and of uniformly distributed directions.}
\]</span></p>
<p>By saying that <span class="math inline">\(W_i\)</span> has a <em>uniformly distributed direction</em>, we mean that <span class="math inline">\(W_i/\|W_i\|\)</span> is uniformly distributed on the <span class="math inline">\(n\)</span>-sphere. This is satisfied, for instance, if <span class="math inline">\(W_i \sim N(0, \sigma_i^2 I_n)\)</span> and this represents the augmentation of the covariate space through random directions. It is equivalent to saying that the complement of <span class="math inline">\(\text{Span}(X)\)</span> in <span class="math inline">\(\text{Span}(\tilde X)\)</span> is a random subspace. The following proposition shows that the expected value of <span class="math inline">\(R^2_a(Y, \tilde X)\)</span> is invariant under the addition of such covariates and provides the distribution of <span class="math inline">\(R^2_a(Y, \tilde X)\)</span> under <span class="math inline">\(H_0&#39;\)</span>.</p>
<p><strong>Proposition 1.</strong> Let <span class="math inline">\(Y \in \mathbb{R}^n\)</span> and <span class="math inline">\(X \in \mathbb{R}^{n \times p}\)</span> be fixed and let <span class="math inline">\(\tilde X = [X \; W_1 \, \cdots \, W_k]\)</span> be the concatenation of <span class="math inline">\(X\)</span> with <span class="math inline">\(k \leq n- p\)</span> independent random vectors <span class="math inline">\(W_1, \ldots, W_k\)</span> of uniformly distributed directions. Then</p>
<p><span class="math display">\[
\mathbb{E}\left[ R^2_a(Y, \tilde X) \right] = R^2_a(Y, X).
\]</span></p>
<p>and, more precisely, under <span class="math inline">\(H_0\)</span> we have that <span class="math inline">\(R^2_a(Y, \tilde X)\)</span> is distributed as</p>
<p><span class="math display">\[
1-  \frac{(n-1)\| \hat \varepsilon \|^2}{(n-\tilde p) \| Y - \bar Y \|^2}\text{Beta}\left(\tfrac{n-\tilde p}{2}, \tfrac{k}{2} \right)
\]</span></p>
<p>where <span class="math inline">\(\text{Beta}\left(\tfrac{(n-\tilde p)}{2}, \tfrac{k}{2} \right)\)</span> is a Beta random variable of parameters <span class="math inline">\((n-\tilde p)/2\)</span> and <span class="math inline">\(k/2\)</span>.</p>
<p><strong>Proof.</strong> Let <span class="math inline">\(\omega\)</span> be the projection of <span class="math inline">\([W_1 \, \cdots \, W_k]\)</span> on the orthogonal <span class="math inline">\(V\)</span> of <span class="math inline">\(\text{Span}(X)\)</span> and denote by <span class="math inline">\(P_\omega\)</span> the orthogonal projection onto <span class="math inline">\(V_\omega = \text{Span}(\omega)\)</span>. By the Pythagorean theorem we have <span class="math inline">\(\|Y - P_ {\tilde X} Y \|^2 + \|P_\omega \hat \varepsilon\|^2 = \|\hat \varepsilon\|^2\)</span> and hence we may write</p>
<p><span class="math display">\[
    R^2_a(Y, \tilde X) = 1- \frac{(n-1)\|\hat \varepsilon\|^2}{(n-\tilde p) \left\| Y - \bar Y\right\|^2} \left(1 - \frac{\|P_\omega \hat \varepsilon\|^2}{\|\hat \varepsilon\|^2} \right).
\]</span></p>
<p>We now derive the distribution of <span class="math inline">\(\|P_\omega \hat \varepsilon\|^2/\|\hat \varepsilon\|^2\)</span>. This term is the squared norm of projection of the unit vector <span class="math inline">\(\hat \varepsilon / \|\hat \varepsilon\| \in V\)</span> on the random subspace <span class="math inline">\(V_\omega \subset V\)</span>. Let us now introduce a random unitary matrix <span class="math inline">\(U\)</span> obtained by orthonormalizing <span class="math inline">\(\dim(V) = n - p\)</span> random vectors of uniformly distributed directions, so that <span class="math inline">\(P_\omega \hat \varepsilon\)</span> is distributed as the first <span class="math inline">\(k\)</span> components of the vector <span class="math inline">\(U \hat \varepsilon\)</span>. Since <span class="math inline">\(U\hat \varepsilon / \|\hat \varepsilon\|\)</span> is uniformly distributed on the unit sphere of <span class="math inline">\(V\)</span>, it follows that the squared norm of its first <span class="math inline">\(k\)</span> components has a <span class="math inline">\(\text{Beta}(k/2, (n-\tilde p)/2)\)</span> distribution. In other words, we have shown that <span class="math inline">\(\|P_\omega \hat \varepsilon\|^2/\|\hat \varepsilon\|^2 \sim \text{Beta}\left(\tfrac{k}{2}, \tfrac{n-\tilde p}{2} \right)\)</span>.</p>
<p>The expectation of <span class="math inline">\(R^2_a(Y, \tilde X)\)</span> is obtained from this distributional expression. <span class="math inline">\(\Box\)</span></p>
<h3 id="reinterpretation-under-gaussian-hypotheses">Reinterpretation under Gaussian hypotheses</h3>
<p>While the preceding analysis was conditional on the observation of <span class="math inline">\(Y\)</span>, suppose now that <span class="math inline">\(Y = X \beta + \varepsilon\)</span>, where <span class="math inline">\(\varepsilon \sim N(0, \sigma^2)\)</span> for some <span class="math inline">\(\sigma^2 &gt; 0\)</span>. The distribution of <span class="math inline">\(R^2_a(Y, X)\)</span> is then intricately related to the unknown parameter <span class="math inline">\(\beta\)</span>, preventing a direct analysis.</p>
<p>However, as shown in Cramer (1987), the adjusted <span class="math inline">\(R^2\)</span> coefficient can still be understood as compensating for irrelevant covariates: in a correctly specified model, its expected value is invariant under the addition of covariates. This is formalized in Proposition 2 below. We preferred a more elementary proof than found therein, avoiding the rather involved explicit expression of the expected value that depends on the unknown parameter <span class="math inline">\(\beta\)</span>.</p>
<p><strong>Proposition 2.</strong> Suppose <span class="math inline">\(Y = X \beta + \varepsilon\)</span>, where <span class="math inline">\(\beta \in \mathbb{R}^{p}\)</span> and <span class="math inline">\(\varepsilon \sim N(0, \sigma^2 I_n)\)</span> is Gaussian noise. If <span class="math inline">\(\tilde X\)</span> is another design matrix of rank <span class="math inline">\(\tilde p\)</span> such that <span class="math inline">\(\text{Span}(X) \subset \text{Span}(\tilde X)\)</span>, then</p>
<p><span class="math display">\[
\mathbb{E}\left[ R^2_a(Y, \tilde X) \right] = \mathbb{E}\left[R^2_a(Y, X)\right].
\]</span></p>
<p><strong>Remark.</strong> More precisely, we know the conditional distribution of <span class="math inline">\(R^2_a(Y, \tilde X)\)</span> given <span class="math inline">\(R^2_a(Y, X)\)</span>: it is the same as the distribution which appears in the context of Proposition 1. The above results then follows from a simple computation.</p>
<p><strong>Proof.</strong> Let <span class="math inline">\(\hat \varepsilon^{*} = Y - P_ {\tilde X} Y\)</span> and write <span class="math inline">\(\lambda = \left\|\mathbb{E}\left[Y - \bar Y\right]\right\|^2/\sigma^2\)</span>. Then <span class="math inline">\(\frac{\|\hat \varepsilon^{*}\|^2}{\left\|Y - \bar Y\right\|^2}\)</span> is distributed as <span class="math display">\[
    \frac{\sum_ {i=1}^{n - \tilde p} Z_i^2}{\sum_ {i=1}^{n - \tilde p} Z_i^2 + \chi^2_ {\tilde p -1} (\lambda)}
\]</span></p>
<p>for independent <span class="math inline">\(Z_i \sim N(0,1)\)</span> and <span class="math inline">\(\chi^2_ {\tilde p - 1} (\lambda)\)</span> a noncentral <span class="math inline">\(\chi^2\)</span> random variable of parameter <span class="math inline">\(\lambda\)</span>. Hence</p>
<p><span class="math display">\[
\mathbb{E}\left[ \frac{\|\hat \varepsilon^{}\|^2}{\left\|Y - \bar Y\right\|^2} \right] = (n-\tilde p) \mathbb{E}\left[\frac{Z_1^2}{\sum{i=1}^{n - \tilde p} Z_i^2 + \chi^2{\tilde p -1} (\lambda)}\right]
    = (n-\tilde p)K,
\]</span></p>
<p>where <span class="math inline">\(K = \mathbb{E}\left[\frac{Z_1^2}{Z_1^2 + \chi^2_ {n - 2} (\lambda)}\right]\)</span> and <span class="math inline">\(\chi^2_ {n-2}(\lambda)\)</span> is a new and independent noncentral <span class="math inline">\(\chi^2\)</span> random variable. It follows that</p>
<p><span class="math display">\[
    \mathbb{E} \left[R^2_a(Y, \tilde X) \right] = 1 - (n-1)K
\]</span></p>
<p>depends on <span class="math inline">\(\tilde X\)</span> only through <span class="math inline">\(X\)</span> and must equal <span class="math inline">\(\mathbb{E} \left[R^2_a(Y, X) \right]\)</span>. <span class="math inline">\(\Box\)</span></p>
<h3 id="relationship-with-fishers-f-test">Relationship with Fisher’s <span class="math inline">\(F\)</span>-test</h3>
<p>In the context of Proposition 2, suppose in particular that <span class="math inline">\(\tilde X = [X \; W]\)</span>, where <span class="math inline">\(W = [W_1\, \cdots \, W_k]\)</span> is a matrix of additional fixed regressors. Recall that the <span class="math inline">\(F\)</span>-statistic for Fisher’s test with nested models of <span class="math inline">\(p\)</span> and <span class="math inline">\(\tilde p = p + k\)</span> parameters respectively is given by</p>
<p><span class="math display">\[
F = \frac{\| \hat Y_0 - \hat Y \|^2}{\| Y - \hat Y \|^2} \frac{n - \tilde p }{k},
\]</span></p>
<p>where <span class="math inline">\(\hat Y_0 = P_X Y\)</span> and <span class="math inline">\(\hat Y = P_{\tilde X} Y\)</span> are the vector of predicted values for the models corresponding to <span class="math inline">\(X\)</span> and <span class="math inline">\(\tilde X\)</span>. The test of significance devised in Section 2, based on <span class="math inline">\(R^2_a(Y, \tilde X)\)</span>, is then equivalent to Fisher’s <span class="math inline">\(F\)</span>-test of the hypothesis</p>
<p><span class="math display">\[
H_0^{\text{Gauss}}:\; Y = X\beta + \varepsilon\, \text{ where }\,\varepsilon \sim N(0, \sigma^2 I_n).
\]</span></p>
<p>To see this, let <span class="math inline">\(\omega\)</span> be, as in the proof of Proposition 1, the projection of <span class="math inline">\([W_1\,\cdots\,W_k]\)</span> on the orthogonal of <span class="math inline">\(\text{Span}(X)\)</span> and denote by <span class="math inline">\(P_\omega\)</span> the projection on <span class="math inline">\(\text{Span}(\omega)\)</span>. Then the <span class="math inline">\(F\)</span>-statistic can be written as</p>
<p><span class="math display">\[
    F = \frac{\|P_\omega \hat \varepsilon\|^2}{\|\hat \varepsilon - P_\omega \hat \varepsilon \|^2} \frac{n-\tilde p}{k} = \frac{\|P_\omega \hat \varepsilon\|^2/\|\hat \varepsilon\|^2}{1 - \|P_\omega \hat \varepsilon \|^2/\|\hat \varepsilon\|^2} \frac{n-\tilde p}{k}.
\]</span></p>
<p>This is a monotonous invertible transform of <span class="math inline">\(\|P_\omega \hat \varepsilon\|^2/\|\hat \varepsilon\|^2\)</span> which, under <span class="math inline">\(H_0^{\text{Gauss}}\)</span>, follows a Beta distribution of parameters <span class="math inline">\(k/2\)</span> and <span class="math inline">\((n-\tilde p)/2\)</span>. Yet in the framework of Section 2 and under <span class="math inline">\(H_0\)</span>, where now <span class="math inline">\(\omega\)</span> is random and <span class="math inline">\(\hat \varepsilon\)</span> fixed, the test statistic <span class="math inline">\(R^2_ a(Y, \tilde X)\)</span> is also a monotonous invertible function of <span class="math inline">\(\|P_ \omega \hat \varepsilon\|^2/\|\hat \varepsilon\|^2 \sim \text{Beta}(k/2, (n-\tilde p)/2)\)</span>. This shows that the two unilateral tests are equivalent: the same observations yield the same <span class="math inline">\(p\)</span>-values.</p>
<h2 id="discussion">Discussion</h2>
<p>We have highlighted dual perspectives on nested models comparison. An increase of <span class="math inline">\(R^2\)</span> may be due to random noise that correlates with fixed regressors, or to random regressors that correlate with fixed observations. Fisher’s test of the first hypothesis is equivalent to the <span class="math inline">\(R^2_a\)</span> test of the second. Furthermore, we showed that <span class="math inline">\(R^2_a\)</span> compensates properly, on the average, for both types of inflation of <span class="math inline">\(R^2\)</span>. We suggest this provides a clear explanation of what <span class="math inline">\(R^2_a\)</span> exactly adjusts for and how it can properly be used for models comparison.</p>
<p>Furthermore, the fact that random covariate tests, conditional on the observations, can be carried out exactly using any measure of goodness of fit (e.g. the likelihood or the AIC) suggests that our approach may be helpful in devising nested model comparison tests for GLMs. Testing at a chosen confidence level also provides more flexibility than using a rule-based procedure such as the AIC.</p>
<p><strong>References</strong></p>
<ul>
<li>Cramer, J. S. (1987). Mean and variance of r2 in small and moderate samples. <em>Journal of Econometrics 35(2)</em>, 253 – 266.</li>
<li>Helland, I. S. (1987). On the interpretation and use of r2 in regression analysis. <em>Biometrics 43(1)</em>, 61–69.</li>
<li>Meepagala, G. (1992). The small sample properties of r2 in a misspecified regression model with stochastic regressors. <em>Economics Letters 40(1)</em>, 1 – 6.</li>
<li>Ohtani, K. and H. Tanizaki (2004). Exact distributions of r2 and adjusted r2 ina linear regression model with multivariate t error terms. <em>Journal of the Japan Statistical Society 34(1)</em>, 101–109.</li>
<li>Olkin, I. and J. W. Pratt (1958). Unbiased estimation of certain correlation coefficients. <em>The Annals of Mathematical Statistics 29(1)</em>, 201–211.</li>
<li>Theil, H. (1971). <em>Principles of econometrics (1 ed.)</em>. New York: J. Wiley.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode r distill-force-highlighting-css"><code class="sourceCode r"></code></pre></div>
<!--radix_placeholder_article_footer-->
<!--/radix_placeholder_article_footer-->
</div>

<div class="d-appendix">
</div>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!--radix_placeholder_site_after_body-->
<!--/radix_placeholder_site_after_body-->
<!--radix_placeholder_appendices-->
<div class="appendix-bottom"></div>
<!--/radix_placeholder_appendices-->
<!--radix_placeholder_navigation_after_body-->
<!--/radix_placeholder_navigation_after_body-->

</body>

</html>
