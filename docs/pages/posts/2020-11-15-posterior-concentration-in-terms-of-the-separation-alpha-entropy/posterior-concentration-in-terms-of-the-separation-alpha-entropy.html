<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Olivier Binette">
<meta name="dcterms.date" content="2019-10-11">
<meta name="description" content="Notes on some research in progress.">

<title>Posterior Concentration in terms of the Separation Alpha-Entropy – Olivier Binette</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="../../../site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="../../../site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="../../../site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "Search",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-059GDHV0GP"></script>

<script type="text/javascript">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-059GDHV0GP', { 'anonymize_ip': false});
</script>
<style>

      .quarto-title-block .quarto-title-banner h1,
      .quarto-title-block .quarto-title-banner h2,
      .quarto-title-block .quarto-title-banner h3,
      .quarto-title-block .quarto-title-banner h4,
      .quarto-title-block .quarto-title-banner h5,
      .quarto-title-block .quarto-title-banner h6
      {
        color: #c00000;
      }

      .quarto-title-block .quarto-title-banner {
        color: #c00000;
background: #f8f8f8;
      }
</style>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="Posterior Concentration in terms of the Separation Alpha-Entropy – Olivier Binette">
<meta property="og:description" content="Notes on some research in progress.">
<meta property="og:site_name" content="Olivier Binette">
<meta name="twitter:title" content="Posterior Concentration in terms of the Separation Alpha-Entropy – Olivier Binette">
<meta name="twitter:description" content="Notes on some research in progress.">
<meta name="twitter:card" content="summary">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../index.html">
    <span class="navbar-title">Olivier Binette</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../pages/blog.html"> 
<span class="menu-text">Blog</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-creations" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Creations</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-creations">    
        <li>
    <a class="dropdown-item" href="../../../pages/research.html">
 <span class="dropdown-text">Publications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../pages/software.html">
 <span class="dropdown-text">Software</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../pages/teaching.html">
 <span class="dropdown-text">Teaching</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item compact">
    <a class="nav-link" href="https://www.github.com/OlivierBinette"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../../pages/blog.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default toc-left page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Posterior Concentration in terms of the Separation Alpha-Entropy</h1>
                  <div>
        <div class="description">
          <p>Notes on some research in progress.</p>
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">technical</div>
                <div class="quarto-category">math</div>
                <div class="quarto-category">statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Olivier Binette </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">October 11, 2019</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#the-framework" id="toc-the-framework" class="nav-link active" data-scroll-target="#the-framework">The framework</a>
  <ul class="collapse">
  <li><a href="#prior-and-posterior-distributions" id="toc-prior-and-posterior-distributions" class="nav-link" data-scroll-target="#prior-and-posterior-distributions">Prior and posterior distributions</a></li>
  </ul></li>
  <li><a href="#separation-alpha-entropy" id="toc-separation-alpha-entropy" class="nav-link" data-scroll-target="#separation-alpha-entropy">Separation <span class="math inline">\(\alpha\)</span>-entropy</a></li>
  <li><a href="#posterior-consistency" id="toc-posterior-consistency" class="nav-link" data-scroll-target="#posterior-consistency">Posterior consistency</a></li>
  <li><a href="#posterior-concentration" id="toc-posterior-concentration" class="nav-link" data-scroll-target="#posterior-concentration">Posterior concentration</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<p>This post continues the series on posterior concentration under misspecification. Here I introduce an unifying point of view on the subject through the introduction of the <em>separation <span class="math inline">\(\alpha\)</span>-entropy</em>. We use this notion of prior entropy to bridge the gap between Bayesian fractional posteriors and regular posterior distributions: in the case where this entropy is finite, direct analogues to some of the concentration results for fractional posteriors (Bhattacharya et al., 2019) are recovered.</p>
<p>This post is going to be quite abstract, just like last week. I’ll talk in a future post about how this separation <span class="math inline">\(\alpha\)</span>-entropy generalizes generalizes the covering numbers for testing under misspecification of Kleijn et al.&nbsp;(2006) as well as the prior summability conditions of De Blasi et al.&nbsp;(2013).</p>
<p>Quick word of warning: this is not the definitive version of the results I’m working on, but I still had to get them out somewhere.</p>
<p>Another word of warning: Wordpress has gotten significantly worse at dealing with math recently. I will find a new platform, but for now expect to find typos and some rendering issues.</p>
<section id="the-framework" class="level2">
<h2 class="anchored" data-anchor-id="the-framework">The framework</h2>
<p>We continue in the same theoretical framework as before: <span class="math inline">\(\mathbb{F}\)</span> is a set of densities on a complete and separable metric space <span class="math inline">\(\mathcal{X}\)</span> with respect to a <span class="math inline">\(\sigma\)</span>-finite measure <span class="math inline">\(\mu\)</span> defined on the Borel <span class="math inline">\(\sigma\)</span>-algebra of <span class="math inline">\(\mathcal{X}\)</span>, <span class="math inline">\(H\)</span> is the Hellinger distance defined by <span class="math display">\[ H(f, g) = \left(\int \left(\sqrt{f} - \sqrt{g}\right)^2 \, d\mu\right)^{1/2}\]</span> and we make use of the Rényi divergences defined by <span class="math display">\[ d_\alpha(f, g) = -\alpha^{-1}\log A_\alpha(f, g),\quad A_\alpha(f, g) = \int f^{\alpha}g^{1-\alpha} \,d\mu .\]</span> Here we assume that data is generated following a distribution <span class="math inline">\(f_0 \in \mathbb{F}\)</span> having a density in our model (this assumption could be weakened), and therefore defined the <em>off-centered</em> Rényi divergence <span class="math display">\[ d_\alpha^{f_0}(f, f^\star) = -\alpha^{-1}\log(A_\alpha^{f_0}(f, f^\star))\]</span> where <span class="math display">\[ A_\alpha^{f_0}(f, f^\star) = \int (f/f^\star)^\alpha f_0\,d\mu\]</span> assuming that all this is well defined.</p>
<section id="prior-and-posterior-distributions" class="level3">
<h3 class="anchored" data-anchor-id="prior-and-posterior-distributions">Prior and posterior distributions</h3>
<p>Now let <span class="math inline">\(\Pi\)</span> be a prior on <span class="math inline">\(\mathbb{F}\)</span>. Given either a single data point <span class="math inline">\(X \sim f_0\)</span> or a sequence of independent variables <span class="math inline">\(X^{(n)} = \{X_i\}_{i=1}^n\)</span> with common probability density function <span class="math inline">\(f_0\)</span>, the posterior distribution of <span class="math inline">\(\Pi\)</span> given <span class="math inline">\(X^{(n)}\)</span> is the random quantity <span class="math inline">\(\Pi(\cdot \mid X^{(n)})\)</span> defined by <span class="math display">\[ \Pi\left(A\mid X^{(n)}\right) = \int_A \prod_{i=1}^n f(X_i) \Pi(df)\Big/ \int_{\mathbb{F}} \prod_{i=1}^n f(X_i) \Pi(df)\]</span> and <span class="math inline">\(\Pi(\cdot \mid X) = \Pi(\cdot \mid X^{(1)})\)</span>. This may not always be well-defined, but I don’t want to get into technicalities for now.</p>
</section>
</section>
<section id="separation-alpha-entropy" class="level2">
<h2 class="anchored" data-anchor-id="separation-alpha-entropy">Separation <span class="math inline">\(\alpha\)</span>-entropy</h2>
<p>We state our concentration results in terms of the separation <span class="math inline">\(\alpha\)</span>-entropy. It is inspired by the Hausdorff <span class="math inline">\(\alpha\)</span>-entropy introduced in Xing et al.&nbsp;(2009), although the separation <span class="math inline">\(\alpha\)</span>-entropy has no relationship with the Hausdorff measure and instead builds upon the concept of <span class="math inline">\(\delta\)</span>-separation of Choi et al.&nbsp;(2008) defined below.</p>
<p>Given a set <span class="math inline">\(A \subset \mathbb{F}\)</span>, we denote by <span class="math inline">\(\langle A \rangle\)</span> the convex hull of <span class="math inline">\(A\)</span>: it is the set of all densities of the form <span class="math inline">\(\int_A f \,\nu(df)\)</span> where <span class="math inline">\(\nu\)</span> is a probability measure on <span class="math inline">\(A\)</span>.</p>
<p><strong>Definition</strong> (<span class="math inline">\(\delta\)</span>-separation). Let <span class="math inline">\(f_0 \in \mathbb{F}\)</span> be fixed as above. A set of densities <span class="math inline">\(A \subset \mathbb{F}\)</span> is said to be <span class="math inline">\(\delta\)</span>-separated from <span class="math inline">\(f^\star \in \mathbb{F}\)</span> with respect to the divergence <span class="math inline">\(d_\alpha^{f_0}\)</span> if for every <span class="math inline">\(f \in \langle A \rangle\)</span>, <span class="math display">\[ d_\alpha^{f_0}\left(f, f^\star\right) \geq \delta.\]</span> A collection of sets <span class="math inline">\(\{A_i\}_{i=1}^\infty\)</span> is said to be <span class="math inline">\(\delta\)</span>-separated from <span class="math inline">\(f_0\)</span> if every $A {A_i}_{i=1}^$ is <span class="math inline">\(\delta\)</span>-separated from <span class="math inline">\(f_0\)</span>.</p>
<p>An important property of <span class="math inline">\(\delta\)</span>-separation, first noted by Walker (2004) and used for the study of posterior consistency, is that it scales with product densities. The general statement of the result is stated in the following lemma.</p>
<p><strong>Lemma</strong> (Separation of product densities). <em>Let <span class="math inline">\((\mathcal{X}_i, \mathcal{B}_{i}, \mu_i)\)</span>, <span class="math inline">\(i \in\{ 1,2, \dots, n\}\)</span>, be a sequence of <span class="math inline">\(\sigma\)</span>-finite measured spaces where each <span class="math inline">\(\mathcal{X}_i\)</span> is a complete and separable locally compact metric space and <span class="math inline">\(\mathcal{B}_i\)</span> is the corresponding Borel <span class="math inline">\(\sigma\)</span>-algebra. Denote by <span class="math inline">\(\mathbb{F}_i\)</span> the set of probability density functions on <span class="math inline">\((\mathcal{X}_i, \mathcal{B}{i}, \mu_i)\)</span>, fix <span class="math inline">\(f_{0,i} \in \mathbb{F}_i\)</span> and let <span class="math inline">\(A_i \subset \mathbb{F}_i\)</span> be <span class="math inline">\(\delta_i\)</span>-separated from <span class="math inline">\(f_{i}^\star \in \mathbb{F}_i\)</span> with respect to <span class="math inline">\(d_\alpha^{f_{0,i}}\)</span> for some <span class="math inline">\(\delta_i \geq 0\)</span>. Let <span class="math inline">\(\prod_{i=1}^n A_i = \left\{\prod_{i=1}^n f_{i} \mid f_i \in \mathbb{F}_i\right\}\)</span> where <span class="math inline">\(\prod_{i=1}^n f_i\)</span> is the product density on <span class="math inline">\(\prod_{i=1}^n \mathcal{X}_i\)</span> defined by <span class="math inline">\((x_1, \dots, x_n) \mapsto \prod_{i=1}^n f_i(x_i)\)</span>. Then <span class="math inline">\(\prod_{i=1}^nA_i\)</span> is <span class="math inline">\(\left(\sum_{i=1}^n\delta_i\right)\)</span>-separated from <span class="math inline">\(\prod_{i=1}^n f_{i}^\star\)</span> with respect to <span class="math inline">\(d_\alpha^{f_0}\)</span> where <span class="math inline">\(f_0 = \prod_{i=1}^nf_{0,i}\)</span>.</em></p>
<p>We can now define the <em>separation <span class="math inline">\(\alpha\)</span>-entropy</em> of a set <span class="math inline">\(A\subset \mathbb{F}\)</span> with parameter <span class="math inline">\(\delta &gt; 0\)</span> as the minimal <span class="math inline">\(\alpha\)</span>-entropy of a <span class="math inline">\(\delta\)</span>-separated covering of <span class="math inline">\(A\)</span>. When this entropy is finite, we can study the concentration properties of the posterior distribution using simple information-theoretic techniques similar to those used in Bhattacharya (2019) for the study of Bayesian fractional posteriors.</p>
<p><strong>Definition</strong> (Separation <span class="math inline">\(\alpha\)</span>-entropy). Fix <span class="math inline">\(\delta &gt; 0\)</span>, <span class="math inline">\(\alpha \in (0,1)\)</span> and let <span class="math inline">\(A\)</span> be a subset of <span class="math inline">\(\mathbb{F}\)</span>. Recall <span class="math inline">\(\Pi\)</span>, <span class="math inline">\(f_0\)</span> and <span class="math inline">\(f^\star\)</span> fixed as previously. The <em>separation <span class="math inline">\(\alpha\)</span>-entropy</em> of <span class="math inline">\(A\)</span> is defined as <span class="math display">\[ \mathcal{S}_\alpha^\star(A, \delta) = \mathcal{S}_\alpha^\star(A, \delta; \Pi, f_0, f^\star) = \inf \,(1-\alpha)^{-1} \log \sum_{i=1}^\infty \left(\frac{\Pi(A_i)}{\Pi(A)}\right)^\alpha\]</span> where the infimum is taken over all (measurable) families <span class="math inline">\(\{A_i\}_{i=1}^\infty\)</span>, <span class="math inline">\(A_i \subset \mathbb{F}\)</span>, satisfying <span class="math inline">\(\Pi(A \backslash (\cup_{i}A_i)) = 0\)</span> and which are <span class="math inline">\(\delta\)</span>-separated from <span class="math inline">\(f_0\)</span> with respect to the divergence <span class="math inline">\(d_\alpha^{f_0}\)</span>. When no such covering exists we let <span class="math inline">\(\mathcal{S}_\alpha(A, \delta) = \infty\)</span>, and when <span class="math inline">\(\Pi(A) = 0\)</span> we define <span class="math inline">\(\mathcal{S}_\alpha(A, \delta) = 0\)</span>.</p>
<p><strong>Remark.</strong> <em>When <span class="math inline">\(f_0 = f^\star\)</span>, so that <span class="math inline">\(d_\alpha^{f_0}(f, f^\star) = d_\alpha(f, f_0)\)</span>, we drop the indicator <span class="math inline">\(\star\)</span> and denote <span class="math inline">\(\mathcal{S}_\alpha(A, \delta) = \mathcal{S}^\star(A, \delta)\)</span>, to emphasize the fact.</em></p>
<p><strong>Proposition</strong> (Properties of the separation <span class="math inline">\(\alpha\)</span>-entropy). <em>The separation <span class="math inline">\(\alpha\)</span>-entropy <span class="math inline">\(\mathcal{S}_\alpha^\star(A, \delta)\)</span> of a set <span class="math inline">\(A\subset \mathbb{F}\)</span> is non-negative and <span class="math inline">\(\mathcal{S}_\alpha(A, \delta) = 0\)</span> if <span class="math inline">\(A\)</span> is <span class="math inline">\(\delta\)</span>-separated from <span class="math inline">\(f^\star\)</span> with respect to the divergence <span class="math inline">\(d_\alpha^{f_0}\)</span>. Furthermore, if <span class="math inline">\(0 &lt; \alpha \leq \beta &lt; 1\)</span> and <span class="math inline">\(0 &lt; \delta \leq \delta'\)</span>, then</em><br>
<span class="math display">\[ {}\mathcal{S}_\alpha^\star(A, \delta) \leq \mathcal{S}_\alpha^\star(A, \delta')\]</span> <em>and if also <span class="math inline">\(f^\star = f_0\)</span>, then</em><br>
<span class="math display">\[ {}\mathcal{S}_\beta(A, \tfrac{1-\beta}{\beta}\delta) \leq \mathcal{S}_\alpha(A, \tfrac{1-\alpha}{\alpha}\delta).\]</span> <em>For a subset <span class="math inline">\(A \subset B \subset \mathbb{F}\)</span> with <span class="math inline">\(\Pi(A) &gt; 0\)</span>, we have</em></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="img.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" title="img"><img src="img.png" class="img-fluid figure-img" alt="img"></a></p>
<figcaption>img</figcaption>
</figure>
</div>
<p><em>and, more generally, if <span class="math inline">\(A \subset \bigcup_{n=1}^\infty B_n\)</span> for subsets <span class="math inline">\(B_n \subset \mathbb{F}\)</span>, then</em> <span class="math display">\[ {}\Pi(A)^{\alpha}\left(\exp\mathcal{S}_\alpha^\star(A, \delta)\right)^{1-\alpha}         \leq \sum_{n=1}^\infty \Pi(B_n)^\alpha \left(\exp\mathcal{S}_\alpha^\star(B_n, \delta)\right)^{1-\alpha}.\]</span></p>
</section>
<section id="posterior-consistency" class="level2">
<h2 class="anchored" data-anchor-id="posterior-consistency">Posterior consistency</h2>
<p><strong>Theorem</strong> (Posterior consistency). <em>Let <span class="math inline">\(f_0, f^\star \in \mathbb{F}\)</span> and let <span class="math inline">\(\{X_i\}\)</span> be a sequence of independent random variables with common probability density <span class="math inline">\(f_0\)</span>. Suppose there exists <span class="math inline">\(\delta &gt; 0\)</span> such that</em> <span class="math display">\[ \Pi\left({f \in \mathbb{F} \mid D(f_0| f) &lt; \delta}\right) &gt; 0.\]</span> <em>If <span class="math inline">\(A \subset \mathbb{F}\)</span> satisfies <span class="math inline">\(\mathcal{S}_\alpha^\star\left(A, \delta\right) &lt; \infty\)</span> for some <span class="math inline">\(\alpha \in (0,1)\)</span>, then <span class="math inline">\(\Pi\left(A\mid \{X_i\}_{i=1}^n\right) \rightarrow 0\)</span> almost surely as <span class="math inline">\(n\rightarrow \infty\)</span>.</em></p>
<p><strong>Remark.</strong> <em>The condition <span class="math inline">\(\mathcal{S}_\alpha^\star(A, \delta) &lt; \infty\)</span> implies in particular that <span class="math inline">\(A \subset \{f\in \mathbb{F} \mid d_\alpha^{f_0}(f, f^\star) \geq \delta\}\)</span>.</em></p>
<p><strong>Corollary</strong> (Well-specified consistency). <em>Suppose that <span class="math inline">\(f_0\)</span> is in the Kullback-Leibler support of <span class="math inline">\(\Pi\)</span>. If <span class="math inline">\(A \subset \mathbb{F}\)</span> satisfies <span class="math inline">\(\mathcal{S}_\alpha(A, \delta) &lt; \infty\)</span> for some <span class="math inline">\(\alpha \in (0,1)\)</span> and for some <span class="math inline">\(\delta &gt; 0\)</span>, then <span class="math inline">\(\Pi_n(A) \rightarrow 0\)</span> almost surely as <span class="math inline">\(n \rightarrow \infty\)</span>.</em></p>
<p><strong>Corollary</strong> (Well-specified Hellinger consistency). <em>Suppose that <span class="math inline">\(f_0\)</span> is in the Kullback-Leibler support of <span class="math inline">\(\Pi\)</span> and fix <span class="math inline">\(\varepsilon &gt; 0\)</span>. If there exists a covering <span class="math inline">\(\{A_i\}_{i=1}^\infty\)</span> of <span class="math inline">\(\mathbb{F}\)</span> by Hellinger balls of diameter at most <span class="math inline">\(\delta &lt; \varepsilon\)</span> satisfying <span class="math inline">\(\sum_{i=1}^\infty \Pi(A_i)^\alpha &lt; \infty\)</span> for some <span class="math inline">\(\alpha \in (0,1)\)</span>, then <span class="math inline">\(\Pi_n\left(\left\{f \in \mathbb{F} \mid H(f, f_0) \geq \varepsilon \right\}\right) \rightarrow 0\)</span> almost surely as <span class="math inline">\(n\rightarrow \infty\)</span>.</em></p>
</section>
<section id="posterior-concentration" class="level2">
<h2 class="anchored" data-anchor-id="posterior-concentration">Posterior concentration</h2>
<p>Following Kleijn et al.&nbsp;(2006) and Bhattacharya et al.&nbsp;(2019), we let <span class="math display">\[ B(\delta, f^\star;f_0) = \left\{ f\in \mathbb{F} \mid \int \log \left(\frac{f}{f^\star}\right) f_0 \,d\mu \leq \delta,\, \int \left(\log \left(\frac{f}{f^\star}\right)\right)^2 f_0 \,d\mu \leq \delta \right\}\]</span> be a Kullback-Leibler type neighborhood of <span class="math inline">\(f^\star\)</span> (relatively to <span class="math inline">\(f_0\)</span>) where the second moment of the log likelihood ratio <span class="math inline">\(\log(f/f^\star)\)</span> is also controlled.</p>
<p><strong>Theorem</strong> (Posterior concentration bound). <em>Let <span class="math inline">\(f_0, f^\star \in \mathbb{F}\)</span> and let <span class="math inline">\(X \sim f_0\)</span>. For any <span class="math inline">\(\delta &gt; 0\)</span> and <span class="math inline">\(\kappa &gt; 1\)</span> we have that</em> <span class="math display">\[ \log\Pi(A \mid X) \leq \frac{1-\alpha}{\alpha}\mathcal{S}_\alpha^\star(A, \kappa \delta)- \log\Pi(B(\delta, f^\star;f_0)) - \kappa\delta\]</span> <em>holds with probability at least <span class="math inline">\(1-8/(\alpha^2\delta)\)</span>.</em></p>
<p><strong>Corollary</strong> (Posterior concentration bound, i.i.d. case). <em>Let <span class="math inline">\(f_0, f^\star \in \mathbb{F}\)</span> and let <span class="math inline">\(\{X_i\}\)</span> be a sequence of independent random variables with common probability density <span class="math inline">\(f_0\)</span>. For any <span class="math inline">\(\delta &gt; 0\)</span> and <span class="math inline">\(\kappa &gt; 1\)</span> we have that</em> <span class="math display">\[ \log\Pi\left(A \mid \{X_i\}_{i=1}^n\right) \leq \frac{1-\alpha}{\alpha}\mathcal{S}_\alpha^\star(A, \kappa \delta)- \log\Pi(B(\delta, f^\star;f_0)) - n\kappa\delta\]</span> <em>holds with probability at least <span class="math inline">\(1-8/(\alpha^2 n \delta)\)</span>.</em></p>
<p><strong>References</strong></p>
<ul>
<li>Bhattacharya, A., D. Pati, and Y. Yang (2019).Bayesian fractional posteriors.Ann.Statist. 47(1), 39–66.</li>
<li>Choi, T. and R. V. Ramamoorthi (2008).Remarks on consistency of posterior distributions,Volume Volume 3, pp.&nbsp;170–186. Beachwood, Ohio, USA: Institute of Mathematical Statistics.</li>
<li>De Blasi, P. and S. G. Walker (2013). Bayesian asymptotics with misspecified models.StatisticaSinica, 169–187.</li>
<li>Grünwald, P. and T. van Ommen (2017). Inconsistency of bayesian inference for misspecifiedlinear models, and a proposal for repairing it.Bayesian Anal. 12(4), 1069–1103.</li>
<li>Kleijn, B. J., A. W. van der Vaart, et al.&nbsp;(2006). Misspecification in infinite-dimensional bayesianstatistics.The Annals of Statistics 34(2), 837–877.</li>
<li>Ramamoorthi, R. V., K. Sriram, and R. Martin (2015). On posterior concentration in misspec-ified models.Bayesian Anal. 10(4), 759–789.</li>
<li>Walker, S. (2004). New approaches to Bayesian consistency.Ann. Statist. 32(5), 2028–2043.</li>
<li>Xing, Y. and B. Ranneby (2009). Sufficient conditions for Bayesian consistency. J. Stat. Plan.Inference 139(7), 2479–2489.</li>
</ul>


</section>

<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-reuse"><h2 class="anchored quarto-appendix-heading">Reuse</h2><div class="quarto-appendix-contents"><div><a rel="license" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a></div></div></section><section class="quarto-appendix-contents" id="quarto-copyright"><h2 class="anchored quarto-appendix-heading">Copyright</h2><div class="quarto-appendix-contents"><div>Olivier Binette</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/olivierbinette\.ca");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="olivierbinette/olivierbinette.github.io" data-repo-id="MDEwOlJlcG9zaXRvcnkxNTk0Mzc2MjQ=" data-category="General" data-category-id="DIC_kwDOCYDTOM4CA7V-" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
<input type="hidden" id="giscus-base-theme" value="light">
<input type="hidden" id="giscus-alt-theme" value="dark">
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 Copyright © 2024 Olivier Binette
  </li>  
</ul>
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","descPosition":"bottom","selector":".lightbox","closeEffect":"zoom","loop":false});
(function() {
  let previousOnload = window.onload;
  window.onload = () => {
    if (previousOnload) {
      previousOnload();
    }
    lightboxQuarto.on('slide_before_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      const href = trigger.getAttribute('href');
      if (href !== null) {
        const imgEl = window.document.querySelector(`a[href="${href}"] img`);
        if (imgEl !== null) {
          const srcAttr = imgEl.getAttribute("src");
          if (srcAttr && srcAttr.startsWith("data:")) {
            slideConfig.href = srcAttr;
          }
        }
      } 
    });
  
    lightboxQuarto.on('slide_after_load', (data) => {
      const { slideIndex, slideNode, slideConfig, player, trigger } = data;
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(slideNode);
      }
    });
  
  };
  
})();
          </script>




</body></html>